/*!
 * flipnote.js v1.3.0
 * Real-time, browser-based playback of Flipnote Studio's .ppm animation format
 * 2018 James Daniel
 * github.com/jaames/flipnote.js
 * Flipnote Studio is (c) Nintendo Co., Ltd.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.flipnote=t():e.flipnote=t()}(this,function(){return function(e){function t(a){if(r[a])return r[a].exports;var i=r[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.e?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,r){"use strict";function a(e){return e&&e.e?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(3),o=a(s),u=r(4),l=a(u),f=function(){function e(t,r,a,n){i(this,e),t.width=r||256,t.height=a||192;var s=t.getContext("webgl",n||{antialias:!1}),u=s.createProgram();this.program=u,this.el=t,this.gl=s,this.t(s.VERTEX_SHADER,o.default),this.t(s.FRAGMENT_SHADER,l.default),s.linkProgram(u),s.useProgram(u);var f=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,f),s.bufferData(s.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,1,1,-1,-1,1,-1]),s.STATIC_DRAW),s.enableVertexAttribArray(0),s.vertexAttribPointer(0,2,s.FLOAT,!1,0,0),this.r("u_layer1Bitmap",0,s.TEXTURE0),this.r("u_layer2Bitmap",1,s.TEXTURE1)}return n(e,[{key:"_createShader",value:function(e,t){var r=this.gl,a=r.createShader(e);r.shaderSource(a,t),r.compileShader(a),r.attachShader(this.program,a)}},{key:"_createTexture",value:function(e,t,r){var a=this.gl;a.uniform1i(a.getUniformLocation(this.program,e),t),a.activeTexture(r),a.bindTexture(a.TEXTURE_2D,a.createTexture()),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST)}},{key:"setColor",value:function(e,t){this.gl.uniform4f(this.gl.getUniformLocation(this.program,e),t[0]/255,t[1]/255,t[2]/255,t[3]/255)}},{key:"setPalette",value:function(e){this.setColor("u_paperColor",e[0]),this.setColor("u_layer1Color",e[1]),this.setColor("u_layer2Color",e[2])}},{key:"setBitmaps",value:function(e){var t=this.gl;t.activeTexture(t.TEXTURE0),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,256,192,0,t.ALPHA,t.UNSIGNED_BYTE,e[0]),t.activeTexture(t.TEXTURE1),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,256,192,0,t.ALPHA,t.UNSIGNED_BYTE,e[1])}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:192;this.el.width=e,this.el.height=t,this.gl.viewport(0,0,e,t)}},{key:"refresh",value:function(){this.gl.drawArrays(this.gl.TRIANGLES,0,6)}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}}]),e}();t.default=f},function(e,t,r){"use strict";var a=r(2),i=function(e){return e&&e.e?e:{default:e}}(a);e.exports={version:"1.3.0",player:i.default}},function(e,t,r){"use strict";function a(e){return e&&e.e?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),o=a(s),u=r(5),l=a(u),f=r(6),h=a(f),c=r(9),d=a(c),m=r(13),p=a(m),_={1:.5,2:1,3:2,4:4,5:6,6:12,7:20,8:30},v=function(){function e(t,r,a){i(this,e),t="string"==typeof t?document.querySelector(t):t,this.canvas=new o.default(t,r,a),this.a=new l.default,this.u=!1,this.f={},this.loop=!1,this.currentFrame=0,this.paused=!0,this.audioTracks=[new p.default("bgm"),new p.default("se1"),new p.default("se2"),new p.default("se3")]}return n(e,[{key:"_load",value:function(e){var t=new h.default(e),r=t.meta;this.ppm=t,this.meta=r,this.frameCount=t.frameCount,this.frameSpeed=t.frameSpeed,this.loop=1==r.loop,this.paused=!0,this.u=!0,t.soundMeta.se1.length&&this.audioTracks[0].set(this.ppm.decodeAudio("se1"),1),t.soundMeta.se2.length&&this.audioTracks[1].set(this.ppm.decodeAudio("se2"),1),t.soundMeta.se3.length&&this.audioTracks[2].set(this.ppm.decodeAudio("se3"),1),t.soundMeta.bgm.length&&this.audioTracks[3].set(this.ppm.decodeAudio("bgm"),this.h),this._=this.ppm.decodeSoundFlags(),this.v=0,this.y=0,this.g=!1,this.setFrame(this.ppm.thumbFrameIndex),this.emit("load")}},{key:"open",value:function(e){var t=this;return this.u&&this.close(),(0,d.default)(e).then(function(e){t.k(e)}).catch(function(e){console.error("Error loading Flipnote:",e)})}},{key:"close",value:function(){this.pause(),this.ppm=null,this.u=!1,this.paused=!0,this.loop=null,this.meta=null,this.frameCount=null,this.frameSpeed=null,this.b=0;for(var e=0;e<this.audioTracks.length;e++)this.audioTracks[e].unset();this._=null,this.g=null,this.canvas.clear()}},{key:"_playFrameSe",value:function(e){for(var t=this._[e],r=0;r<t.length;r++)t[r]&&this.audioTracks[r].active&&this.audioTracks[r].start()}},{key:"_playBgm",value:function(){this.audioTracks[3].start(this.currentTime)}},{key:"_stopAudio",value:function(){for(var e=0;e<this.audioTracks.length;e++)this.audioTracks[e].stop()}},{key:"_playbackLoop",value:function(e){var t=(e-this.y)/(1e3/60),r=this.currentFrame;this.v>=60/this.framerate&&(this.T(r),this.nextFrame(),this.v=0),r>=this.frameCount-1&&(this.F(),this.loop?(this.firstFrame(),this.U(0),this.emit("playback:loop")):(this.pause(),this.emit("playback:end"))),this.v+=t,this.y=e,this.paused||requestAnimationFrame(this.w.bind(this))}},{key:"play",value:function(){if(!this.u||!this.paused)return null;this.paused=!1,this.g&&(this.loop||this.currentFrame!=this.frameCount-1)||(this.b=0),this.y=performance.now(),this.U(),this.w(this.y),this.g=!0,this.emit("playback:start")}},{key:"pause",value:function(){if(!this.u||this.paused)return null;this.paused=!0,this.F(),this.emit("playback:stop")}},{key:"getFrameImage",value:function(e,t,r){return this.u?(e=Math.max(0,Math.min(e,this.frameCount-1)),this.a.setPalette(this.ppm.getFramePalette(e)),this.a.setBitmaps(this.ppm.decodeFrame(e)),this.a.refresh(),this.a.toImage(t,r)):null}},{key:"getThumbImage",value:function(e,t){return this.getFrameImage(this.ppm.thumbFrameIndex,e,t)}},{key:"setFrame",value:function(e){if(!this.u||e===this.currentFrame)return null;e=Math.max(0,Math.min(e,this.frameCount-1)),this.b=e,this.v=0,this.canvas.setPalette(this.ppm.getFramePalette(e)),this.canvas.setBitmaps(this.ppm.decodeFrame(e)),this.canvas.refresh(),this.emit("frame:update",this.currentFrame)}},{key:"thumbnailFrame",value:function(){this.currentFrame=this.ppm.thumbFrameIndex}},{key:"nextFrame",value:function(){this.loop&&this.currentFrame>=this.frameCount-1?this.currentFrame=0:this.currentFrame+=1}},{key:"prevFrame",value:function(){this.loop&&this.currentFrame<=0?this.currentFrame=this.frameCount-1:this.currentFrame-=1}},{key:"lastFrame",value:function(){this.currentFrame=this.frameCount-1}},{key:"firstFrame",value:function(){this.currentFrame=0}},{key:"resize",value:function(e,t){this.canvas.resize(e,t)}},{key:"on",value:function(e,t){var r=this.f;(r[e]||(r[e]=[])).push(t)}},{key:"off",value:function(e,t){var r=this.f[e];r&&r.splice(r.indexOf(t),1)}},{key:"emit",value:function(e){for(var t=this.f[e]||[],r=arguments.length,a=Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];for(var n=0;n<t.length;n++)t[n].apply(null,a)}},{key:"currentFrame",get:function(){return this.b},set:function(e){this.setFrame(e)}},{key:"currentTime",get:function(){return this.u?this.currentFrame*(1/this.framerate):null},set:function(e){this.u&&e<this.duration&&e>0&&(this.setFrame(Math.round(e/(1/this.framerate))),this.v=0)}},{key:"volume",get:function(){return this.audioTracks[3].audio.volume},set:function(e){for(var t=0;t<this.audioTracks.length;t++)this.audioTracks[t].audio.volume=e}},{key:"muted",get:function(){return this.audioTracks[3].audio.muted},set:function(e){for(var t=0;t<this.audioTracks.length;t++)this.audioTracks[t].audio.muted=e}},{key:"duration",get:function(){return this.u?this.frameCount*(1/this.framerate):null}},{key:"framerate",get:function(){return _[this.frameSpeed]}},{key:"_audiorate",get:function(){return 1/_[this.ppm.bgmSpeed]/(1/_[this.frameSpeed])}}]),e}();t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["attribute vec4 a_position;","varying vec2 v_texcoord;","void main() {","gl_Position = a_position;","v_texcoord = a_position.xy * vec2(0.5, -0.5) + 0.5;","}"].join("\n")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["precision lowp float;","varying vec2 v_texcoord;","uniform vec4 u_paperColor;","uniform vec4 u_layer1Color;","uniform vec4 u_layer2Color;","uniform sampler2D u_layer1Bitmap;","uniform sampler2D u_layer2Bitmap;","void main() {","float layer1 = texture2D(u_layer1Bitmap, v_texcoord).a;","float layer2 = texture2D(u_layer2Bitmap, v_texcoord).a;","gl_FragColor = (layer1 == 0.0) ? (layer2 == 0.0) ? u_paperColor : u_layer2Color : u_layer1Color;","}"].join("\n")},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=r(0),u=function(e){return e&&e.e?e:{default:e}}(o),l=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,document.createElement("canvas"),256,192,{antialias:!1,preserveDrawingBuffer:!0}))}return n(t,e),s(t,[{key:"toImage",value:function(e,t){return this.el.toDataURL(e,t)}}]),t}(u.default);t.default=l},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=r(7),u=function(e){return e&&e.e?e:{default:e}}(o),l=r(8),f=256,h=192,c=[14,14,14,255],d=[255,255,255,255],m=[10,57,255,255],p=[255,42,42,255],_=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.seek(4),r.P=r.readUint32(),r.x=r.readUint32(),r.frameCount=Math.min(r.readUint16()+1,999),r.seek(18),r.thumbFrameIndex=r.readUint16(),r.seek(1696);var n=r.readUint16();return r.seek(1704),r.O=new Uint32Array(n/4).map(function(e){return 1704+n+r.readUint32()}),r.meta=r.A(),r.C(),r.R=[new Uint8Array(f*h),new Uint8Array(f*h)],r.S=[new Uint8Array(f*h),new Uint8Array(f*h)],r.M=0,r}return n(t,e),s(t,[{key:"_seekToFrame",value:function(e){this.seek(this.O[e])}},{key:"_seekToAudio",value:function(e){this.seek(this.soundMeta[e].offset)}},{key:"_readUtf16",value:function(e){for(var t="",r=!1,a=0;a<e/2;a++){var i=this.readUint16();r||0==i?r=!0:t+=String.fromCharCode(i)}return t}},{key:"_readHex",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],a=0;a<e;a++)r.push(this.readUint8().toString(16).padStart(2,"0"));return t&&r.reverse(),r.join("").toUpperCase()}},{key:"_readFilename",value:function(){var e="";e+=this.L(3)+"_";for(var t=0;t<13;t++)e+=String.fromCharCode(this.readUint8());return e+="_",e+=this.readUint16().toString().padStart(3,"0")}},{key:"_readLineEncoding",value:function(){for(var e=new Uint8Array(h),t=0;t<48;t++)for(var r=this.readUint8(),a=0;a<8;a+=2)e[4*t+a/2]=r>>a&3;return e}},{key:"_decodeMeta",value:function(){this.seek(16);var e=this.readUint16(),t=this.readInt16(),r=this.j(22),a=this.j(22),i=this.j(22),n=this.L(8,!0),s=this.L(8,!0),o=this.I(),u=this.I(),l=this.L(8,!0);this.seek(154);var f=new Date(1e3*(this.readUint32()+946684800));return this.seek(27232),{lock:e,loop:this.readUint16()>>1&1,frame_count:this.frameCount,thumb_index:t,timestamp:f,spinoff:s!==n,root:{username:r,fsid:l},parent:{username:a,fsid:n,filename:o},current:{username:i,fsid:s,filename:u}}}},{key:"_decodeSoundHeader",value:function(){var e=1696+this.P+this.frameCount;e%4!=0&&(e+=4-e%4),this.seek(e);var t=this.readUint32(),r=this.readUint32(),a=this.readUint32(),i=this.readUint32();this.frameSpeed=8-this.readUint8(),this.bgmSpeed=8-this.readUint8(),e+=32,this.soundMeta={bgm:{offset:e,length:t},se1:{offset:e+=t,length:r},se2:{offset:e+=r,length:a},se3:{offset:e+=a,length:i}}}},{key:"_isFrameNew",value:function(e){return this.D(e),this.readUint8()>>7&1}},{key:"_decodePrevFrames",value:function(e){for(var t=0,r=0;!r;)t+=1,r=this.B(e-t);for(t=e-t;t<e;)this.decodeFrame(t,!1),t+=1;this.D(e),this.seek(1,1)}},{key:"getFramePalette",value:function(e){this.D(e);var t=this.readUint8(),r=1&t,a=[null,1==r?c:d,p,m];return[1==r?d:c,a[t>>1&3],a[t>>3&3]]}},{key:"decodeFrame",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.D(e);var r=this.readUint8(),a=r>>7&1,i=r>>5&3,n=0,s=0;t&&!a&&e!==this.M+1&&this.X(e),this.S[0].set(this.R[0]),this.S[1].set(this.R[1]),this.M=e,this.R[0].fill(0),this.R[1].fill(0),i&&(n=this.readInt8(),s=this.readInt8());for(var o=[this.H(),this.H()],u=0;u<2;u++)for(var l=this.R[u],c=0;c<h;c++){var d=c*f,m=o[u][c];switch(m){case 0:break;case 1:case 2:var p=this.readUint32(!1);for(2==m&&l.fill(1,d,d+f);4294967295&p;){if(2147483648&p)for(var _=this.readUint8(),v=0;v<8;v++)l[d+v]=_>>v&1;d+=8,p<<=1}break;case 3:for(;d<(c+1)*f;){for(var _=this.readUint8(),v=0;v<8;v++)l[d+v]=_>>v&1;d+=8}}}if(!a)for(var y,g,k,b=0;b<h;b++)for(var T=0;T<f;T++)y=T+b*f,g=y-(n+s*f),k=T-n>f||T-n<0,this.R[0][y]=k?this.R[0][y]:this.R[0][y]^this.S[0][g],this.R[1][y]=k?this.R[1][y]:this.R[1][y]^this.S[1][g];return this.R}},{key:"decodeAudio",value:function(e){var t=this;this.N(e);var r=new Uint8Array(this.soundMeta[e].length).map(function(e){return t.readUint8()});return(0,l.decodeAdpcm)(r)}},{key:"decodeSoundFlags",value:function(){var e=this;return this.seek(1696+this.P),new Array(this.frameCount).fill([]).map(function(t){var r=e.readUint8();return[1&r,r>>1&1,r>>2&1]})}}]),t}(u.default);t.default=_},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){a(this,e),this.G=new DataView(t),this.V=0}return i(e,[{key:"seek",value:function(e,t){switch(t){case 2:this.V=this.G.byteLength+e;break;case 1:this.V+=e;break;case 0:default:this.V=e}}},{key:"readUint8",value:function(){var e=this.G.getUint8(this.V);return this.V+=1,e}},{key:"readInt8",value:function(){var e=this.G.getInt8(this.V);return this.V+=1,e}},{key:"readUint16",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.G.getUint16(this.V,e);return this.V+=2,t}},{key:"readInt16",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.G.getInt16(this.V,e);return this.V+=2,t}},{key:"readUint32",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.G.getUint32(this.V,e);return this.V+=4,t}},{key:"readInt32",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.G.getInt32(this.V,e);return this.V+=4,t}},{key:"fileLength",get:function(){return this.G.byteLength}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){u=0,l=0;for(var t=new Int16Array(2*e.length),r=0,a=0;a<e.length;a++){var n=e[a];t[r]=i(15&n),t[r+1]=i(n>>4&15),r+=2}return t}function i(e){var t=u,r=l,a=o[r],i=a>>3;return 4&e&&(i+=a),2&e&&(i+=a>>1),1&e&&(i+=a>>2),t+=8&e?-i:i,r+=s[e],r=n(r,0,88),t=n(t,-32767,32767),u=t,l=r,t}function n(e,t,r){return e<=t?t:e>=r?r:e}Object.defineProperty(t,"__esModule",{value:!0}),t.decodeAdpcm=a;var s=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],o=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],u=0,l=0},function(e,t,r){"use strict";function a(e){return e&&e.e?e:{default:e}}function i(e){return new Promise(function(t,r){for(var a=0;a<h.length;a++){var i=h[a];if(i.matches(e)){i.load(e,t,r);break}}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(10),s=a(n),o=r(11),u=a(o),l=r(12),f=a(l),h=[s.default,u.default,f.default]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={matches:function(e){return"string"==typeof e},load:function(e,t,r){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onreadystatechange=function(e){4===a.readyState&&(a.status>=200&&a.status<300?t(a.response):r({type:"httpError",status:a.status,statusText:a.statusText}))},a.send(null)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={matches:function(e){return!1},load:function(e,t,r){r()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={matches:function(e){return e instanceof ArrayBuffer},load:function(e,t,r){t(e)}}},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){a(this,e),this.id=t,this.channelCount=1,this.bitsPerSample=16,this.sampleRate=8192,this.playbackRate=1,this.audio=document.createElement("audio"),this.audio.preload=!0,this.active=!1}return i(e,[{key:"set",value:function(e,t){var r=new DataView(new ArrayBuffer(44));r.setUint32(0,1179011410,!0),r.setUint32(4,r.byteLength+e.byteLength,!0),r.setUint32(8,1163280727,!0),r.setUint32(12,544501094,!0),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,this.channelCount,!0),r.setUint32(24,this.sampleRate*t,!0),r.setUint32(28,this.sampleRate*t*this.bitsPerSample*this.channelCount/8,!0),r.setUint16(32,this.bitsPerSample*this.channelCount/8,!0),r.setUint16(34,this.bitsPerSample,!0),r.setUint32(36,1635017060,!0),r.setUint32(40,e.byteLength,!0),this.url=window.URL.createObjectURL(new Blob([r.buffer,e.buffer],{type:"audio/wav"})),this.audio.src=this.url,this.active=!0,this.playbackRate=t}},{key:"unset",value:function(){this.active&&(window.URL.revokeObjectURL(this.url),this.audio.src="",this.audio.load(),this.active=!1,this.playbackRate=1)}},{key:"start",value:function(e){this.active&&(this.audio.currentTime=e||0,this.audio.play())}},{key:"stop",value:function(){this.active&&this.audio.pause()}}]),e}();t.default=n}])});